# 已完成功能清单

## ✅ Phase 1: MVP (最小可行产品)

### 核心功能
- ✅ **任务管理**
  - 添加任务（标题 + 描述）
  - 编辑任务
  - 删除任务
  - 标记完成/未完成
  - 任务选择和高亮

- ✅ **任务属性**
  - 任务标题（最多100字符）
  - 任务描述（最多255字符）
  - 完成状态（完成/未完成）
  - 优先级（低/中/高）
  - 唯一ID（UUID）

- ✅ **用户界面**
  - 主GUI界面（按K键打开）
  - 任务列表显示
  - 输入框（标题、描述、标签）
  - 操作：添加任务、删除任务、保存列表
  - 通过复选框切换完成状态
  - 筛选按钮（进行中、已完成、高优先、中优先、低优先）
  - 顶部搜索框，支持按标题/描述/标签实时过滤任务

### 数据持久化
- ✅ **本地存储**
  - NBT格式保存
  - 自动保存功能（关闭GUI时）
  - 手动保存按钮
  - 加载已保存的任务

### 用户体验
- ✅ **键盘快捷键**
  - `K` 键打开待办列表
  - `Esc` 键关闭界面

- ✅ **鼠标操作**
  - 鼠标滚轮滚动任务列表
  - 拖动滚动条
  - 点击选择任务

- ✅ **视觉反馈**
  - 完成状态复选框
  - 优先级颜色编码
  - 悬停高亮效果
  - 滚动条显示

### 多语言支持
- ✅ 中文界面
- ✅ 英文界面
- ✅ GUI、HUD和配置界面文本全部使用多语言key（可随游戏语言切换）

## ✅ Phase 2: 增强功能（已完成部分）

### HUD显示
- ✅ **HUD任务列表**
  - 在屏幕右上角显示待办列表
  - 显示待办/已完成数量
  - 显示按优先级排序的任务列表
  - 支持展开/收起（按 H 键切换）
  - 保存后立即刷新HUD内容
  - HUD标题显示当前视图（个人 / 团队-待分配 / 团队-已分配 / 团队-分配给我）
  - 在真正的单人世界中HUD默认列表视图固定为个人视图，HUD中不显示团队视图

### GUI增强
- ✅ **任务优先级选择器**
  - GUI中提供高/中/低三个优先级按钮
  - 创建任务时选择优先级
  - 编辑任务时修改优先级
  - 优先级按钮和列表色块使用对应颜色

- ✅ **任务标签基础支持**
  - 任务支持添加/编辑标签（逗号分隔）
  - GUI列表显示首个标签
  - HUD中显示任务标签
  - 标签在GUI和HUD中使用颜色标记，提升可读性

- ✅ **任务完成规则优化**
  - 已完成任务只读（不能修改标题、描述、标签和优先级）
  - 仅允许删除已完成任务

### 配置系统
- ✅ **HUD配置界面**
  - 可配置HUD宽度和最大高度
  - 通过滑块配置待办/已完成显示条数（0–30）
  - 可配置HUD默认展开状态
  - 默认展开与“无任务时仍显示HUD”使用按钮开关切换
  - 可在配置界面预览并拖动HUD位置
  - 支持自定义HUD坐标（右上角为默认位置）
  - 可在配置界面切换HUD默认列表视图（个人 / 团队-待分配 / 团队-已分配 / 团队-分配给我），在真正的单人世界中此项固定为个人且按钮禁用

### 多人 & 团队任务
- ✅ **团队任务列表与权限控制**
  - 支持个人视图与团队视图（待分配 / 已分配 / 分配给我）
  - 团队任务由服务器端存储，并同步到所有玩家
  - 管理员可以完整管理团队任务（添加、编辑、删除、指派、完成）
  - 普通玩家仅能对团队任务执行“领取、放弃、勾选完成”，且必须点击保存按钮后统一提交
  - 保存时进行权限和冲突校验，若被他人修改则自动刷新列表并提示玩家
  - 在团队视图中点击保存、取消或按 Esc 关闭界面后，客户端都会向服务器请求最新的团队任务列表，丢弃未保存的本地修改，保证与服务器数据一致
  - 团队HUD视图与GUI视图完全统一：待分配仅显示未指派任务，已分配仅显示已有指派的任务，“分配给我”仅显示指派给当前玩家的任务
  - 团队任务操作（完成状态切换、领取、放弃、指派他人）在服务器端通过统一权限中心校验
  - 所有通过校验且真正生效的团队任务操作都会以统一格式记录到服务器操作日志中，包含玩家名、操作类型、任务ID以及变更详情
  - 普通玩家在团队视图中只显示“领取任务”和“放弃任务”按钮，“指派他人”按钮仅对管理员可见

- ✅ **指派界面与玩家名显示**
  - “指派他人”界面使用固定高度可滚动列表展示在线玩家，并在顶部提供实时搜索框按玩家名过滤。
  - 团队任务保存时会在服务器端根据指派人 UUID 写入当前玩家名缓存；GUI 列表和 HUD 在展示 `[玩家名, 标签]` 时，会优先使用在线玩家名，否则退回任务中缓存的玩家名，即使指派的玩家已下线，团队视图与HUD中的标签仍保留其姓名。

### 列表和排序行为
- ✅ 优先级过滤时，未完成任务优先显示在已完成任务之前

## ✅ Bug修复（已完成）

### UI布局问题
- ✅ 标题与筛选按钮重叠问题已修复
- ✅ 完成按钮与任务列表重叠问题已修复
- ✅ 任务标签与玩家名称在列表和HUD中的显示区域优化（考虑滚动条宽度、增加省略号、防止文本超出）

### 功能问题
- ✅ 鼠标滚轮滚动功能已实现
- ✅ 滚动条拖动功能已实现
- ✅ 保存列表功能已实现（自动保存 + 手动保存按钮）
- ✅ 修复在视图切换后返回原视图时，原先选中的任务标题会被清空的问题
- ✅ 修复从服务器切换到单人游戏时，HUD列表仍显示团队任务视图的问题
- ✅ 修复团队视图中取消或按 Esc 关闭时未正确丢弃未保存修改并与服务器同步的问题

## 📊 当前状态

**版本**: 1.0.0  
**Minecraft版本**: 1.20.1  
**Mod加载器**: Fabric 0.14.21+  
**构建状态**: ✅ 成功

---

*最后更新: 2026-02-21*
