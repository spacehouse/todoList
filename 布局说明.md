# 界面布局说明 - 版本 1.2.0

## 🎨 全新布局设计

### 布局结构

新的界面采用清晰的五行布局，所有元素居中对齐，互不重叠：

```
┌─────────────────────────────────────────────┐
│ 待办事项列表    [全部][进行中][已完成] [⚙] │
├─────────────────────────────────────────────┤
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │ 任务列表区域                          │  │
│  │ ☐ 任务1（低优先级）      🔵          │  │
│  │ ☐ 任务2（中优先级）      🟡          │  │
│  │ ☑ 任务3（已完成）         🔴          │  │
│  │ ...                                 │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │ 标题输入框                            │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │ 描述输入框                            │  │
│  └───────────────────────────────────────┘  │
│                                             │
│           ┌─────┐ ┌─────┐ ┌─────┐          │
│           │ 低  │ │ 中  │ │ 高  │          │
│           └─────┘ └─────┘ └─────┘          │
│                                             │
│        ┌──────┐ ┌──────┐ ┌──────┐         │
│        │ 添加  │ │ 编辑  │ │ 删除  │         │
│        └──────┘ └──────┘ └──────┘         │
│                                             │
│           ┌──────┐ ┌──────┐              │
│           │ 保存  │ │ 取消  │              │
│           └──────┘ └──────┘              │
│                                             │
└─────────────────────────────────────────────┘
```

---

## 📋 详细说明

### 第1行：标题输入框
- **宽度**: 全宽（占满整个GUI宽度）
- **占位符**: "输入任务标题..."
- **最大长度**: 100字符
- **用途**: 输入任务的主要名称

### 第2行：描述输入框
- **宽度**: 全宽
- **占位符**: "描述（可选）..."
- **最大长度**: 255字符
- **用途**: 输入任务的详细描述（可选）

### 第3行：优先级按钮
- **布局**: 居中对齐
- **按钮**: 三个等宽按钮（低/中/高）
- **宽度**: 每个按钮70像素
- **间距**: 按钮之间4像素间距
- **用途**: 选择任务的优先级
- **颜色**:
  - 低 = 青色（0xFF55FFFF）
  - 中 = 黄色（0xFFFFFF00）
  - 高 = 红色（0xFFFF5555）

### 第4行：操作按钮
- **布局**: 居中对齐
- **按钮**: 添加、编辑、删除
- **宽度**: 每个按钮70像素
- **间距**: 按钮之间5像素间距
- **状态**:
  - 未选中任务时：编辑和删除按钮禁用（灰色）
  - 选中任务后：所有按钮启用

### 第5行：保存/取消按钮
- **布局**: 居中对齐
- **按钮**: 保存、取消
- **宽度**: 每个按钮90像素
- **间距**: 按钮之间5像素间距
- **用途**:
  - 保存：手动保存任务到文件
  - 取消：关闭界面（自动保存）

---

## 🎯 设计原则

### 1. 清晰的层次结构
```
标题输入（最重要）
  ↓
描述输入（详细信息）
  ↓
优先级选择（任务分类）
  ↓
操作按钮（任务管理）
  ↓
保存/取消（界面控制）
```

### 2. 居中对齐
- 所有按钮组都居中对齐
- 视觉平衡，更美观
- 符合现代UI设计原则

### 3. 合理间距
- 元素之间使用 `elementSpacing`（默认5像素）
- 按钮组之间使用 `elementSpacing * 2`（10像素）
- 视觉上清晰分隔

### 4. 避免重叠
- 每个元素独占一行
- 按钮大小和位置经过精确计算
- 保存/取消按钮紧跟在操作按钮后面

---

## 📐 尺寸计算

### 垂直位置（从上到下）
```java
// 任务列表区域
listY = y + config.getTaskListY()
listHeight = config.getTaskListHeight()

// 输入区域起始
inputStartY = listY + listHeight + elementSpacing + 4

// 第1行：标题
titleY = inputStartY

// 第2行：描述
descY = titleY + buttonHeight + elementSpacing

// 第3行：优先级
priorityY = descY + buttonHeight + elementSpacing

// 第4行：操作按钮
actionY = priorityY + buttonHeight + elementSpacing

// 第5行：保存/取消
saveY = actionY + buttonHeight + elementSpacing * 2
```

### 水平居中计算
```java
// 优先级按钮（3个按钮，每个70px，间距4px）
totalWidth = 70 * 3 + 4 * 2 = 218px
startX = (guiWidth - totalWidth) / 2

// 操作按钮（3个按钮，每个70px，间距5px）
totalWidth = 70 * 3 + 5 * 2 = 220px
startX = (guiWidth - totalWidth) / 2

// 保存/取消按钮（2个按钮，每个90px，间距5px）
totalWidth = 90 * 2 + 5 = 185px
startX = (guiWidth - totalWidth) / 2
```

---

## 🔧 配置建议

### 小屏幕（宽度 < 400px）
```
guiWidth: 350
guiHeight: 320
taskListHeight: 120
```

### 标准屏幕（推荐）
```
guiWidth: 400
guiHeight: 350
taskListHeight: 140
```

### 大屏幕
```
guiWidth: 500
guiHeight: 400
taskListHeight: 180
```

---

## 💡 使用流程

### 添加新任务
1. 在第1行输入任务标题
2. 在第2行输入描述（可选）
3. 在第3行选择优先级（默认：中）
4. 点击第4行的"添加"按钮

### 编辑任务
1. 点击任务列表中的任务选中
2. 修改第1行的标题
3. 修改第2行的描述
4. 在第3行选择新的优先级
5. 点击第4行的"编辑"按钮

### 删除任务
1. 点击任务列表中的任务选中
2. 点击第4行的"删除"按钮

### 完成/取消完成
1. 直接点击任务前面的复选框（☐）
2. 已完成显示绿色勾号（☑）
3. 再次点击取消完成状态

### 保存并退出
1. 点击第5行的"保存"按钮（手动保存）
2. 或点击"取消"按钮（自动保存并关闭）

---

## ✅ 测试清单

使用此清单测试新布局：

- [ ] 第1行标题输入框全宽显示
- [ ] 第2行描述输入框全宽显示
- [ ] 第3行优先级按钮居中对齐
- [ ] 第4行操作按钮居中对齐
- [ ] 第5行保存/取消按钮居中对齐
- [ ] 所有元素无重叠
- [ ] 所有按钮间距合理
- [ ] 编辑/删除按钮未选中时禁用
- [ ] 选中任务后编辑/删除按钮启用

---

## 🐛 已修复的问题

### ✅ 问题1：控件排列混乱
- **之前**: 标题、描述、按钮在同一行，宽度不合理
- **现在**: 每个元素独占一行，全宽或居中对齐

### ✅ 问题2：按钮重叠
- **之前**: 操作按钮与保存/取消按钮位置冲突
- **现在**: 使用 `currentY` 累加Y坐标，确保不重叠

### ✅ 问题3：优先级按钮位置
- **之前**: 优先级按钮与标题输入框在同一行
- **现在**: 优先级按钮独占一行，居中对齐

---

## 📊 对比

| 方面 | 之前 | 现在 |
|------|------|------|
| 布局方式 | 混乱，多行共用 | 清晰，每行一个元素 |
| 对齐方式 | 左对齐 | 居中对齐 |
| 重叠问题 | 有重叠 | 无重叠 |
| 视觉效果 | ⭐⭐ | ⭐⭐⭐⭐⭐ |
| 易用性 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 🎨 视觉效果

新布局特点：
- ✅ 所有元素垂直排列，从上到下逻辑清晰
- ✅ 按钮组居中对齐，视觉平衡
- ✅ 全宽输入框，最大化输入空间
- ✅ 合理间距，不会拥挤
- ✅ 无重叠，所有控件清晰可见

---

**版本**: 1.2.0
**更新日期**: 2026-02-10
**兼容性**: Minecraft 1.20.1 + Fabric
